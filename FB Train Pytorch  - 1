{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":23,"status":"ok","timestamp":1646627379039,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"},"user_tz":-330},"id":"5FVoORh9IcHf","outputId":"5bf14367-9f63-4c8c-9103-f7eb248855ad"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mon Mar  7 04:29:39 2022       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  A100-SXM4-40GB      Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   42C    P0    45W / 400W |      0MiB / 40536MiB |      0%      Default |\n","|                               |                      |             Disabled |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["!nvidia-smi"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"ADQLdZUeJxIp","executionInfo":{"status":"ok","timestamp":1646627379040,"user_tz":-330,"elapsed":19,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["# ! gdown --id 1i2x7osfloYkXDHMRn0WuVs2P3m751cj1\n","# ! pip -q uninstall -y kaggle\n","# ! pip -q install --upgrade pip\n","# ! pip -q install kaggle --upgrade\n","# ! mkdir ~/.kaggle\n","# ! cp kaggle.json ~/.kaggle/\n","# ! chmod 600 ~/.kaggle/kaggle.json\n","# ! kaggle competitions download feedback-prize-2021\n","# ! kaggle datasets download aishikai/fb-corrected-train\n","# ! kaggle datasets download nbroad/deberta-v2-3-fast-tokenizer\n","# ! kaggle datasets download aishikai/fb-deberta"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"42762gveJz91","executionInfo":{"status":"ok","timestamp":1646627379041,"user_tz":-330,"elapsed":20,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["# ! unzip -q /content/feedback-prize-2021.zip -d data\n","# ! rm /content/feedback-prize-2021.zip\n","# ! unzip -q /content/fb-corrected-train.zip -d data\n","# ! rm /content/fb-corrected-train.zip\n","# ! unzip -q /content/deberta-v2-3-fast-tokenizer.zip -d tokenizer\n","# ! rm /content/deberta-v2-3-fast-tokenizer.zip\n","# ! unzip -q /content/fb-deberta.zip -d deberta\n","# ! rm /content/fb-deberta.zip"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"nZC0LIw9J07W","executionInfo":{"status":"ok","timestamp":1646627379041,"user_tz":-330,"elapsed":19,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["# !pip install -qq sentencepiece\n","# !pip install -qq transformers\n","# !pip install -qq iterative-stratification"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"oK8WB7TCABGz","executionInfo":{"status":"ok","timestamp":1646627379041,"user_tz":-330,"elapsed":19,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["import shutil\n","from pathlib import Path\n","\n","transformers_path = Path(\"/usr/local/lib/python3.7/dist-packages/transformers\")\n","\n","input_dir = Path(\"/content/tokenizer\")\n","\n","convert_file = input_dir / \"convert_slow_tokenizer.py\"\n","conversion_path = transformers_path/convert_file.name\n","\n","if conversion_path.exists():\n","    conversion_path.unlink()\n","\n","shutil.copy(convert_file, transformers_path)\n","deberta_v2_path = transformers_path / \"models\" / \"deberta_v2\"\n","\n","for filename in ['tokenization_deberta_v2.py', 'tokenization_deberta_v2_fast.py']:\n","    filepath = deberta_v2_path/filename\n","    if filepath.exists():\n","        filepath.unlink()\n","\n","    shutil.copy(input_dir/filename, filepath)"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"s22uSdY1J44o","executionInfo":{"status":"ok","timestamp":1646627382900,"user_tz":-330,"elapsed":3877,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["# general\n","import pandas as pd\n","import numpy as np\n","import os\n","import copy\n","import random\n","from joblib import Parallel, delayed\n","from tqdm.notebook import tqdm\n","from sklearn.model_selection import KFold\n","from sklearn.metrics import accuracy_score\n","from sklearn import metrics\n","from sklearn.model_selection import KFold\n","from iterstrat.ml_stratifiers import MultilabelStratifiedKFold\n","import gc\n","from collections import defaultdict\n","import warnings\n","warnings.filterwarnings(\"ignore\")\n","# nlp\n","from sklearn.feature_extraction.text import CountVectorizer\n","import torch\n","import torch.nn as nn\n","from transformers import AutoConfig, AutoModel, AutoTokenizer, AdamW, get_cosine_schedule_with_warmup\n","from transformers.models.deberta_v2.tokenization_deberta_v2_fast import DebertaV2TokenizerFast\n","from torch.utils.data import Dataset, DataLoader\n","from torch.cuda.amp import autocast, GradScaler"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"kcTD3H4BJ6RM","executionInfo":{"status":"ok","timestamp":1646627382904,"user_tz":-330,"elapsed":96,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["class Config:\n","    savename = \"deberta-large-1600\"\n","    n_folds = 5\n","    num_workers = 12\n","    fold = 0\n","    model = \"microsoft/deberta-large\"\n","    lr = 2.5e-5\n","    n_accum = 1\n","    max_grad_norm = 10\n","    output = \"/content/model\"\n","    input = \"/content/data\"\n","    max_len = 1600\n","    max_len_valid = 1600\n","    num_labels = 15\n","    batch_size = 2\n","    valid_batch_size = 2\n","    epochs = 6\n","    accumulation_steps = 1\n","    device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","    apex = True\n","    debug = False\n","    if debug:\n","        n_folds = 2\n","        epochs = 2"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"QrAL5ThjJ8b1","executionInfo":{"status":"ok","timestamp":1646627382905,"user_tz":-330,"elapsed":95,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["target_id_map = {\n","    \"B-Lead\": 0,\n","    \"I-Lead\": 1,\n","    \"B-Position\": 2,\n","    \"I-Position\": 3,\n","    \"B-Evidence\": 4,\n","    \"I-Evidence\": 5,\n","    \"B-Claim\": 6,\n","    \"I-Claim\": 7,\n","    \"B-Concluding Statement\": 8,\n","    \"I-Concluding Statement\": 9,\n","    \"B-Counterclaim\": 10,\n","    \"I-Counterclaim\": 11,\n","    \"B-Rebuttal\": 12,\n","    \"I-Rebuttal\": 13,\n","    \"O\": 14,\n","    \"PAD\": -100,\n","}\n","\n","\n","id_target_map = {v: k for k, v in target_id_map.items()}"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"SNYlKeWuJ97U","executionInfo":{"status":"ok","timestamp":1646627382905,"user_tz":-330,"elapsed":94,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def create_folds(df):\n","    dfx = pd.get_dummies(df, columns=[\"discourse_type\"]).groupby([\"id\"], as_index=False).sum()\n","    cols = [c for c in dfx.columns if c.startswith(\"discourse_type_\") or c == \"id\" and c != \"discourse_type_num\"]\n","    dfx = dfx[cols]\n","\n","    mskf = MultilabelStratifiedKFold(n_splits=Config.n_folds, shuffle=True, random_state=42)\n","    labels = [c for c in dfx.columns if c != \"id\"]\n","    dfx_labels = dfx[labels]\n","    dfx[\"kfold\"] = -1\n","\n","    for fold, (trn_, val_) in enumerate(mskf.split(dfx, dfx_labels)):\n","        print(len(trn_), len(val_))\n","        dfx.loc[val_, \"kfold\"] = fold\n","\n","    df = df.merge(dfx[[\"id\", \"kfold\"]], on=\"id\", how=\"left\")\n","    print(df.kfold.value_counts())\n","    df.to_csv(\"train_folds.csv\", index=False)\n","    return df"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"L61qRldmJ_Sj","executionInfo":{"status":"ok","timestamp":1646627382906,"user_tz":-330,"elapsed":94,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def _prepare_training_data_helper(Config, tokenizer, df, train_ids):\n","    training_samples = []\n","    for idx in tqdm(train_ids):\n","        filename = os.path.join(Config.input, \"train\", idx + \".txt\")\n","        with open(filename, \"r\") as f:\n","            text = f.read()\n","\n","        encoded_text = tokenizer.encode_plus(\n","            text,\n","            add_special_tokens=False,\n","            return_offsets_mapping=True\n","        )\n","        input_ids = encoded_text[\"input_ids\"]\n","        input_labels = copy.deepcopy(input_ids)\n","        offset_mapping = encoded_text[\"offset_mapping\"]\n","\n","        for k in range(len(input_labels)):\n","            input_labels[k] = \"O\"\n","\n","        sample = {\n","            \"id\": idx,\n","            \"input_ids\": input_ids,\n","            \"text\": text,\n","            \"offset_mapping\": offset_mapping,\n","        }\n","\n","        temp_df = df[df[\"id\"] == idx]\n","        for _, row in temp_df.iterrows():\n","            text_labels = [0] * len(text)\n","            discourse_start = int(row[\"discourse_start\"])\n","            discourse_end = int(row[\"discourse_end\"])\n","            prediction_label = row[\"discourse_type\"]\n","            text_labels[discourse_start:discourse_end] = [1] * (discourse_end - discourse_start)\n","            target_idx = []\n","            for map_idx, (offset1, offset2) in enumerate(encoded_text[\"offset_mapping\"]):\n","                if sum(text_labels[offset1:offset2]) > 0:\n","                    if len(text[offset1:offset2].split()) > 0:\n","                        target_idx.append(map_idx)\n","\n","            targets_start = target_idx[0]\n","            targets_end = target_idx[-1]\n","            pred_start = \"B-\" + prediction_label\n","            pred_end = \"I-\" + prediction_label\n","            input_labels[targets_start] = pred_start\n","            input_labels[targets_start + 1 : targets_end + 1] = [pred_end] * (targets_end - targets_start)\n","\n","        sample[\"input_ids\"] = input_ids\n","        sample[\"input_labels\"] = input_labels\n","        training_samples.append(sample)\n","    return training_samples\n"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"_BKLxRQrKDSu","executionInfo":{"status":"ok","timestamp":1646627382907,"user_tz":-330,"elapsed":93,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def prepare_training_data(df, tokenizer, Config, num_jobs):\n","    training_samples = []\n","    train_ids = df[\"id\"].unique()\n","\n","    train_ids_splits = np.array_split(train_ids, num_jobs)\n","\n","    results = Parallel(n_jobs=num_jobs, backend=\"multiprocessing\")(\n","        delayed(_prepare_training_data_helper)(Config, tokenizer, df, idx) for idx in train_ids_splits\n","    )\n","    for result in results:\n","        training_samples.extend(result)\n","\n","    return training_samples"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"FM50iJkTKDyo","executionInfo":{"status":"ok","timestamp":1646627382908,"user_tz":-330,"elapsed":93,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["class FeedbackDataset:\n","    def __init__(self, samples, max_len, tokenizer):\n","        self.samples = samples\n","        self.max_len = max_len\n","        self.tokenizer = tokenizer\n","        self.length = len(samples)\n","\n","    def __len__(self):\n","        return self.length\n","\n","    def __getitem__(self, idx):\n","        input_ids = self.samples[idx][\"input_ids\"]\n","        input_labels = self.samples[idx][\"input_labels\"]\n","        input_labels = [target_id_map[x] for x in input_labels]\n","        other_label_id = target_id_map[\"O\"]\n","        padding_label_id = target_id_map[\"PAD\"]\n","        # print(input_ids)\n","        # print(input_labels)\n","\n","        # add start token id to the input_ids\n","        input_ids = [self.tokenizer.cls_token_id] + input_ids\n","        input_labels = [other_label_id] + input_labels\n","\n","        if len(input_ids) > self.max_len - 1:\n","            input_ids = input_ids[: self.max_len - 1]\n","            input_labels = input_labels[: self.max_len - 1]\n","\n","        # add end token id to the input_ids\n","        input_ids = input_ids + [self.tokenizer.sep_token_id]\n","        input_labels = input_labels + [other_label_id]\n","\n","        attention_mask = [1] * len(input_ids)\n","\n","        padding_length = self.max_len - len(input_ids)\n","        if padding_length > 0:\n","            if self.tokenizer.padding_side == \"right\":\n","                input_ids = input_ids + [self.tokenizer.pad_token_id] * padding_length\n","                input_labels = input_labels + [padding_label_id] * padding_length\n","                attention_mask = attention_mask + [0] * padding_length\n","            else:\n","                input_ids = [self.tokenizer.pad_token_id] * padding_length + input_ids\n","                input_labels = [padding_label_id] * padding_length + input_labels\n","                attention_mask = [0] * padding_length + attention_mask\n","\n","        return {\n","            \"ids\": torch.tensor(input_ids, dtype=torch.long),\n","            \"mask\": torch.tensor(attention_mask, dtype=torch.long),\n","            \"targets\": torch.tensor(input_labels, dtype=torch.long),\n","        }"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"L9dCvRsNKFeK","executionInfo":{"status":"ok","timestamp":1646627382908,"user_tz":-330,"elapsed":92,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["class FeedbackDatasetValid:\n","    def __init__(self, samples, max_len, tokenizer):\n","        self.samples = samples\n","        self.max_len = max_len\n","        self.tokenizer = tokenizer\n","        self.length = len(samples)\n","\n","    def __len__(self):\n","        return self.length\n","\n","    def __getitem__(self, idx):\n","        input_ids = self.samples[idx][\"input_ids\"]\n","        input_ids = [self.tokenizer.cls_token_id] + input_ids\n","\n","        if len(input_ids) > self.max_len - 1:\n","            input_ids = input_ids[: self.max_len - 1]\n","\n","        # add end token id to the input_ids\n","        input_ids = input_ids + [self.tokenizer.sep_token_id]\n","        attention_mask = [1] * len(input_ids)\n","\n","        return {\n","            \"ids\": input_ids,\n","            \"mask\": attention_mask,\n","        }"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"sgHq6N2sKH-m","executionInfo":{"status":"ok","timestamp":1646627382908,"user_tz":-330,"elapsed":91,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["class Collate:\n","    def __init__(self, tokenizer):\n","        self.tokenizer = tokenizer\n","\n","    def __call__(self, batch):\n","        output = dict()\n","        output[\"ids\"] = [sample[\"ids\"] for sample in batch]\n","        output[\"mask\"] = [sample[\"mask\"] for sample in batch]\n","\n","        # calculate max token length of this batch\n","        batch_max = max([len(ids) for ids in output[\"ids\"]])\n","\n","        # add padding\n","        if self.tokenizer.padding_side == \"right\":\n","            output[\"ids\"] = [s + (batch_max - len(s)) * [self.tokenizer.pad_token_id] for s in output[\"ids\"]]\n","            output[\"mask\"] = [s + (batch_max - len(s)) * [0] for s in output[\"mask\"]]\n","        else:\n","            output[\"ids\"] = [(batch_max - len(s)) * [self.tokenizer.pad_token_id] + s for s in output[\"ids\"]]\n","            output[\"mask\"] = [(batch_max - len(s)) * [0] + s for s in output[\"mask\"]]\n","\n","        # convert to tensors\n","        output[\"ids\"] = torch.tensor(output[\"ids\"], dtype=torch.long)\n","        output[\"mask\"] = torch.tensor(output[\"mask\"], dtype=torch.long)\n","\n","        return output"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"783FvNwmKLCY","executionInfo":{"status":"ok","timestamp":1646627382909,"user_tz":-330,"elapsed":91,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["class FeedbackModel(nn.Module):\n","    def __init__(self, model_name, num_labels):\n","        super().__init__()\n","        self.model_name = model_name\n","        self.num_labels = num_labels\n","\n","        hidden_dropout_prob: float = 0.1\n","        layer_norm_eps: float = 1e-7\n","\n","        config = AutoConfig.from_pretrained(model_name)\n","\n","        config.update(\n","            {\n","                \"output_hidden_states\": True,\n","                \"hidden_dropout_prob\": hidden_dropout_prob,\n","                \"layer_norm_eps\": layer_norm_eps,\n","                \"add_pooling_layer\": False,\n","                \"num_labels\": self.num_labels,\n","            }\n","        )\n","        self.transformer = AutoModel.from_pretrained(model_name, config=config)\n","        self.dropout = nn.Dropout(config.hidden_dropout_prob)\n","        self.dropout1 = nn.Dropout(0.1)\n","        self.dropout2 = nn.Dropout(0.2)\n","        self.dropout3 = nn.Dropout(0.3)\n","        self.dropout4 = nn.Dropout(0.4)\n","        self.dropout5 = nn.Dropout(0.5)\n","        self.output = nn.Linear(config.hidden_size, self.num_labels)\n","\n","    def forward(self, ids, mask, token_type_ids=None):\n","\n","        if token_type_ids:\n","            transformer_out = self.transformer(ids, mask, token_type_ids)\n","        else:\n","            transformer_out = self.transformer(ids, mask)\n","        sequence_output = transformer_out.last_hidden_state\n","        sequence_output = self.dropout(sequence_output)\n","\n","        logits1 = self.output(self.dropout1(sequence_output))\n","        logits2 = self.output(self.dropout2(sequence_output))\n","        logits3 = self.output(self.dropout3(sequence_output))\n","        logits4 = self.output(self.dropout4(sequence_output))\n","        logits5 = self.output(self.dropout5(sequence_output))\n","\n","        logits = (logits1 + logits2 + logits3 + logits4 + logits5) / 5\n","        return logits, logits1, logits2, logits3, logits4, logits5"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"Mz29b6PA5rvS","executionInfo":{"status":"ok","timestamp":1646627382910,"user_tz":-330,"elapsed":92,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def fetch_optimizer(model, learning_rate = Config.lr):\n","    param_optimizer = list(model.named_parameters())\n","    no_decay = [\"bias\", \"LayerNorm.bias\"]\n","    optimizer_parameters = [\n","        {\n","            \"params\": [p for n, p in param_optimizer if not any(nd in n for nd in no_decay)],\n","            \"weight_decay\": 0.01,\n","        },\n","        {\n","            \"params\": [p for n, p in param_optimizer if any(nd in n for nd in no_decay)],\n","            \"weight_decay\": 0.0,\n","        },\n","    ]\n","    opt = AdamW(optimizer_parameters, lr=learning_rate)\n","    return opt\n","\n","def fetch_scheduler(optimizer, num_train_steps):\n","    sch = get_cosine_schedule_with_warmup(\n","        optimizer,\n","        num_warmup_steps=int(0.1 *  num_train_steps),\n","        num_training_steps= num_train_steps,\n","        num_cycles=1,\n","        last_epoch=-1,\n","    )\n","    return sch"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"Iy-rxcakKAiE","executionInfo":{"status":"ok","timestamp":1646627382910,"user_tz":-330,"elapsed":90,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["## Metric Utils\n","def calc_overlap(row):\n","    \"\"\"\n","    Calculates the overlap between prediction and\n","    ground truth and overlap percentages used for determining\n","    true positives.\n","    \"\"\"\n","    set_pred = set(row.predictionstring_pred.split(\" \"))\n","    set_gt = set(row.predictionstring_gt.split(\" \"))\n","    # Length of each and intersection\n","    len_gt = len(set_gt)\n","    len_pred = len(set_pred)\n","    inter = len(set_gt.intersection(set_pred))\n","    overlap_1 = inter / len_gt\n","    overlap_2 = inter / len_pred\n","    return [overlap_1, overlap_2]\n","\n","\n","def score_feedback_comp_micro(pred_df, gt_df):\n","    \"\"\"\n","    A function that scores for the kaggle\n","        Student Writing Competition\n","    Uses the steps in the evaluation page here:\n","        https://www.kaggle.com/c/feedback-prize-2021/overview/evaluation\n","    This code is from Rob Mulla's Kaggle kernel.\n","    \"\"\"\n","    gt_df = gt_df[[\"id\", \"discourse_type\", \"predictionstring\"]].reset_index(drop=True).copy()\n","    pred_df = pred_df[[\"id\", \"class\", \"predictionstring\"]].reset_index(drop=True).copy()\n","    pred_df[\"pred_id\"] = pred_df.index\n","    gt_df[\"gt_id\"] = gt_df.index\n","    # Step 1. all ground truths and predictions for a given class are compared.\n","    joined = pred_df.merge(\n","        gt_df,\n","        left_on=[\"id\", \"class\"],\n","        right_on=[\"id\", \"discourse_type\"],\n","        how=\"outer\",\n","        suffixes=(\"_pred\", \"_gt\"),\n","    )\n","    joined[\"predictionstring_gt\"] = joined[\"predictionstring_gt\"].fillna(\" \")\n","    joined[\"predictionstring_pred\"] = joined[\"predictionstring_pred\"].fillna(\" \")\n","\n","    joined[\"overlaps\"] = joined.apply(calc_overlap, axis=1)\n","\n","    # 2. If the overlap between the ground truth and prediction is >= 0.5,\n","    # and the overlap between the prediction and the ground truth >= 0.5,\n","    # the prediction is a match and considered a true positive.\n","    # If multiple matches exist, the match with the highest pair of overlaps is taken.\n","    joined[\"overlap1\"] = joined[\"overlaps\"].apply(lambda x: eval(str(x))[0])\n","    joined[\"overlap2\"] = joined[\"overlaps\"].apply(lambda x: eval(str(x))[1])\n","\n","    joined[\"potential_TP\"] = (joined[\"overlap1\"] >= 0.5) & (joined[\"overlap2\"] >= 0.5)\n","    joined[\"max_overlap\"] = joined[[\"overlap1\", \"overlap2\"]].max(axis=1)\n","    tp_pred_ids = (\n","        joined.query(\"potential_TP\")\n","        .sort_values(\"max_overlap\", ascending=False)\n","        .groupby([\"id\", \"predictionstring_gt\"])\n","        .first()[\"pred_id\"]\n","        .values\n","    )\n","\n","    # 3. Any unmatched ground truths are false negatives\n","    # and any unmatched predictions are false positives.\n","    fp_pred_ids = [p for p in joined[\"pred_id\"].unique() if p not in tp_pred_ids]\n","\n","    matched_gt_ids = joined.query(\"potential_TP\")[\"gt_id\"].unique()\n","    unmatched_gt_ids = [c for c in joined[\"gt_id\"].unique() if c not in matched_gt_ids]\n","\n","    # Get numbers of each type\n","    TP = len(tp_pred_ids)\n","    FP = len(fp_pred_ids)\n","    FN = len(unmatched_gt_ids)\n","    # calc microf1\n","    my_f1_score = TP / (TP + 0.5 * (FP + FN))\n","    return my_f1_score\n","\n","\n","def score_feedback_comp(pred_df, gt_df, return_class_scores=False):\n","    class_scores = {}\n","    pred_df = pred_df[[\"id\", \"class\", \"predictionstring\"]].reset_index(drop=True).copy()\n","    for discourse_type, gt_subset in gt_df.groupby(\"discourse_type\"):\n","        pred_subset = pred_df.loc[pred_df[\"class\"] == discourse_type].reset_index(drop=True).copy()\n","        class_score = score_feedback_comp_micro(pred_subset, gt_subset)\n","        class_scores[discourse_type] = class_score\n","    f1 = np.mean([v for v in class_scores.values()])\n","    if return_class_scores:\n","        return f1, class_scores\n","    return f1\n"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"4zlX6DRelGR0","executionInfo":{"status":"ok","timestamp":1646627382911,"user_tz":-330,"elapsed":90,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def criterion (outputs, targets, attention_mask):\n","    loss_fct = nn.CrossEntropyLoss()\n","\n","    active_loss = attention_mask.view(-1) == 1\n","    active_logits = outputs.view(-1, Config.num_labels)\n","    true_labels = targets.view(-1)\n","    outputs = active_logits.argmax(dim=-1)\n","    idxs = np.where(active_loss.cpu().numpy() == 1)[0]\n","    active_logits = active_logits[idxs]\n","    true_labels = true_labels[idxs].to(torch.long)\n","\n","    loss = loss_fct(active_logits, true_labels)\n","    return loss"]},{"cell_type":"code","execution_count":19,"metadata":{"id":"MFQpb2zrlmX9","executionInfo":{"status":"ok","timestamp":1646627382912,"user_tz":-330,"elapsed":91,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def monitor_metrics(outputs, targets, attention_mask):\n","    active_loss = (attention_mask.view(-1) == 1).cpu().numpy()\n","    active_logits = outputs.view(-1, Config.num_labels)\n","    true_labels = targets.view(-1).cpu().numpy()\n","    outputs = active_logits.argmax(dim=-1).cpu().numpy()\n","    idxs = np.where(active_loss == 1)[0]\n","    f1_score = metrics.f1_score(true_labels[idxs], outputs[idxs], average=\"macro\")\n","    return {\"f1\": f1_score}"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"exEG5kbHmgrz","executionInfo":{"status":"ok","timestamp":1646627382912,"user_tz":-330,"elapsed":90,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["def score_valid(valid_samples, valid_df):\n","    submission = []\n","    min_thresh = {\n","        \"Lead\": 9,\n","        \"Position\": 5,\n","        \"Evidence\": 14,\n","        \"Claim\": 3,\n","        \"Concluding Statement\": 11,\n","        \"Counterclaim\": 6,\n","        \"Rebuttal\": 4,\n","    }\n","    proba_thresh = {\n","        \"Lead\": 0.7,\n","        \"Position\": 0.55,\n","        \"Evidence\": 0.65,\n","        \"Claim\": 0.55,\n","        \"Concluding Statement\": 0.7,\n","        \"Counterclaim\": 0.5,\n","        \"Rebuttal\": 0.55,\n","    }\n","\n","    for _, sample in enumerate(valid_samples):\n","        preds = sample[\"preds\"]\n","        offset_mapping = sample[\"offset_mapping\"]\n","        sample_id = sample[\"id\"]\n","        sample_text = sample[\"text\"]\n","        sample_pred_scores = sample[\"pred_scores\"]\n","\n","        # pad preds to same length as offset_mapping\n","        if len(preds) < len(offset_mapping):\n","            preds = preds + [\"O\"] * (len(offset_mapping) - len(preds))\n","            sample_pred_scores = sample_pred_scores + [0] * (len(offset_mapping) - len(sample_pred_scores))\n","\n","        idx = 0\n","        phrase_preds = []\n","        while idx < len(offset_mapping):\n","            start, _ = offset_mapping[idx]\n","            if preds[idx] != \"O\":\n","                label = preds[idx][2:]\n","            else:\n","                label = \"O\"\n","            phrase_scores = []\n","            phrase_scores.append(sample_pred_scores[idx])\n","            idx += 1\n","            while idx < len(offset_mapping):\n","                if label == \"O\":\n","                    matching_label = \"O\"\n","                else:\n","                    matching_label = f\"I-{label}\"\n","                if preds[idx] == matching_label:\n","                    _, end = offset_mapping[idx]\n","                    phrase_scores.append(sample_pred_scores[idx])\n","                    idx += 1\n","                else:\n","                    break\n","            if \"end\" in locals():\n","                phrase = sample_text[start:end]\n","                phrase_preds.append((phrase, start, end, label, phrase_scores))\n","\n","        temp_df = []\n","        for phrase_idx, (phrase, start, end, label, phrase_scores) in enumerate(phrase_preds):\n","            word_start = len(sample_text[:start].split())\n","            word_end = word_start + len(sample_text[start:end].split())\n","            word_end = min(word_end, len(sample_text.split()))\n","            ps = \" \".join([str(x) for x in range(word_start, word_end)])\n","            if label != \"O\":\n","                if sum(phrase_scores) / len(phrase_scores) >= proba_thresh[label]:\n","                    temp_df.append((sample_id, label, ps))\n","\n","        temp_df = pd.DataFrame(temp_df, columns=[\"id\", \"class\", \"predictionstring\"])\n","\n","        submission.append(temp_df)\n","\n","    submission = pd.concat(submission).reset_index(drop=True)\n","    submission[\"len\"] = submission.predictionstring.apply(lambda x: len(x.split()))\n","\n","    def threshold(df):\n","        df = df.copy()\n","        for key, value in min_thresh.items():\n","            index = df.loc[df[\"class\"] == key].query(f\"len<{value}\").index\n","            df.drop(index, inplace=True)\n","        return df\n","\n","    submission = threshold(submission)\n","\n","    # drop len\n","    submission = submission.drop(columns=[\"len\"])\n","\n","    scr = score_feedback_comp(submission, valid_df, return_class_scores=True)\n","    return scr"]},{"cell_type":"code","execution_count":21,"metadata":{"id":"fBBdSdneTGpW","executionInfo":{"status":"ok","timestamp":1646627383503,"user_tz":-330,"elapsed":32,"user":{"displayName":"Aishik Rakshit","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgoE8DoXrkkE1neQvac-1XEvBsREdaljei0HYrDfw=s64","userId":"15122983906308089605"}}},"outputs":[],"source":["class Trainer:\n","    def __init__(self, config, dataloaders, valid_df, valid_samples, optimizer, model, loss_fns, scheduler, device=Config.device, apex=Config.apex):\n","        self.train_loader, self.valid_loader = dataloaders\n","        self.train_loss_fn = loss_fns\n","        self.valid_df = valid_df\n","        self.valid_samples = valid_samples\n","        self.scheduler = scheduler\n","        self.optimizer = optimizer\n","        self.model = model\n","        self.device = device\n","        self.apex = apex\n","        self.Config = config\n","    \n","    def train_one_epoch(self):\n","        scaler = GradScaler()\n","\n","        self.model.train()\n","        train_pbar = tqdm(enumerate(self.train_loader), total=len(self.train_loader))\n","        dataset_size = 0\n","        running_loss = 0.0\n","        running_f1 = 0.0\n","\n","        for step, data in train_pbar:        \n","            input_ids = data[\"ids\"].to(self.device)\n","            input_mask = data[\"mask\"].to(self.device)\n","            targets = data[\"targets\"].to(self.device)\n","\n","            batch_size = input_ids.shape[0]\n","\n","            with(autocast(enabled = True)):\n","                logits, logits1, logits2, logits3, logits4, logits5 = self.model(input_ids,\n","                                                                                input_mask)\n","                \n","                loss1 = self.train_loss_fn(logits1, targets, input_mask)\n","                loss2 = self.train_loss_fn(logits2, targets, input_mask)\n","                loss3 = self.train_loss_fn(logits3, targets, input_mask)\n","                loss4 = self.train_loss_fn(logits4, targets, input_mask)\n","                loss5 = self.train_loss_fn(logits5, targets, input_mask)\n","                loss = (loss1 + loss2 + loss3 + loss4 + loss5) / 5.0\n","                loss /= self.Config.n_accum\n","\n","            scaler.scale(loss).backward()\n","\n","            torch.nn.utils.clip_grad_norm_(model.parameters(), Config.max_grad_norm)\n","\n","            if (step + 1) % self.Config.n_accum == 0:\n","                    scaler.step(self.optimizer)\n","                    scaler.update()\n","                    self.optimizer.zero_grad()\n","                    self.scheduler.step()\n","\n","            f1_1 = monitor_metrics(logits1, targets, input_mask)[\"f1\"]\n","            f1_2 = monitor_metrics(logits2, targets, input_mask)[\"f1\"]\n","            f1_3 = monitor_metrics(logits3, targets, input_mask)[\"f1\"]\n","            f1_4 = monitor_metrics(logits4, targets, input_mask)[\"f1\"]\n","            f1_5 = monitor_metrics(logits5, targets, input_mask)[\"f1\"]\n","            f1 = (f1_1 + f1_2 + f1_3 + f1_4 + f1_5) / 5.0\n","\n","            running_loss += (loss.item() * batch_size)  \n","            running_f1 += (f1 * batch_size)  \n","            dataset_size += batch_size\n","            epoch_loss = running_loss / dataset_size\n","            epoch_f1 = running_f1 / dataset_size\n","\n","            train_pbar.set_postfix(Train_Loss = epoch_loss, Train_F1 = epoch_f1, LR = self.optimizer.param_groups[0]['lr'])\n","\n","        return epoch_loss, epoch_f1\n","\n","    @torch.no_grad()\n","    def valid_one_epoch(self):\n","\n","        self.model.eval()\n","        valid_pbar = tqdm(enumerate(self.valid_loader), total=len(self.valid_loader))\n","        dataset_size = 0\n","        valid_preds = []\n","        final_preds = []\n","        final_scores = []\n","        running_loss = 0.0\n","\n","        for step , data in valid_pbar:\n","            input_ids = data[\"ids\"].to(self.device)\n","            input_mask = data[\"mask\"].to(self.device)\n","\n","            batch_size = input_ids.shape[0]\n","            logits, logits1, logits2, logits3, logits4, logits5 = self.model(input_ids,\n","                                                                            input_mask)\n","\n","            dataset_size += batch_size\n","            valid_preds.append(logits.cpu().tolist())\n","        \n","        for preds in valid_preds:\n","            pred_class = np.argmax(preds, axis=2)\n","            pred_scrs = np.max(preds, axis=2)\n","            for pred, pred_scr in zip(pred_class, pred_scrs):\n","                final_preds.append(pred.tolist())\n","                final_scores.append(pred_scr.tolist())\n","\n","        for j in range(len(self.valid_samples)):\n","            tt = [id_target_map[p] for p in final_preds[j][1:]]\n","            tt_score = final_scores[j][1:]\n","            self.valid_samples[j][\"preds\"] = tt\n","            self.valid_samples[j][\"pred_scores\"] = tt_score\n","\n","        valid_score = score_valid(self.valid_samples, self.valid_df)            \n","\n","        return valid_score\n","            \n","\n","    def fit(self, fold: str, epochs: int = 10, output_dir: str = \"/content/models/\", custom_name: str = 'model.pth'):\n","        \"\"\"\n","        Low-effort alternative for doing the complete training and validation process\n","        \"\"\"\n","        best_score = int(-1e+7)\n","        for epx in range(epochs):\n","            print(f\"{'='*20} Epoch: {epx+1} / {epochs} {'='*20}\")\n","\n","            train_loss, train_f1 = self.train_one_epoch()\n","            print(f\"Training loss: {train_loss:.4f} Training f1: {train_f1:.4f}\")\n","\n","            valid_score = self.valid_one_epoch()\n","\n","            print(valid_score)\n","            \n","            valid_score = valid_score[0]\n","            print(f'Validation Score: {valid_score:.4f}')\n","\n","            custom_name = f\"model_{fold}\"\n","            if valid_score > best_score:\n","                best_score = valid_score\n","                self.save_model(output_dir, custom_name)\n","                print(f\"Saved model with val_score: {best_score:.4f}\")\n","            \n","\n","    def save_model(self, path, name, verbose=False):\n","        \"\"\"\n","        Saves the model at the provided destination\n","        \"\"\"\n","        try:\n","            if not os.path.exists(path):\n","                os.makedirs(path)\n","        except:\n","            print(\"Errors encountered while making the output directory\")\n","\n","        torch.save(self.model.state_dict(), os.path.join(path, name))\n","        if verbose:\n","            print(f\"Model Saved at: {os.path.join(path, name)}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["e644566c906c43548674e19c0186aee8","d88e2ed4cf8c4a0baff0e8116dfe09e0","671fdff3cf0345cdb2747c5d9f5850eb","59f18f261c2e4770b0cbfd8b2026713d","189f84fc133c4db5a7ea22c3e8007483","cd62091139b94bb18c6a3b29d14f3d37","dc8d4fee5beb4c4f97bcbcb20fd273a1","52aaa717be2c4557b7c18706e29a8f41","82064fb7e26649b48901631c8e7c0b3e","14c159c08757403a92984dd9d180780e","68fd6cc7b8af450f8cfa5bae844d8be5","783ce614985241cba817b1f7dfc05f9f","e38244e2380a4acd80639aadc2e3aae8","15913776fa634e288bea19ace1b13f70","61e6d4dc41444e8494589bd8cc2be82c","6f8637f8f1294c4982754c64b045ac26","197212a17cb7479da176793418fc458a","b98f6879773f45a7b2bf7523dd1d5880","2047cbd9da834930a3ed27fede5bb54e","27e1b63dc8b44c1aa944690c2d0ea6a6","887462b628cd4535954cd8f4e0a8cf3c","3d018af7a6c34e40a4d03ee8a0fbf6ee","22ff59eff56d4c83836a16f44124888a","ceff6e6318ef41979e42164dbb4c474f","cfffd69f142e4e11b5b7fc8d06899745","e3ff827dfa304672bc150118f0d5649b","0f84e59931904720bf271b427cd089d8","a1869837763641f1821125b1bcfbfdc9","cc0dcc1deb5d44a2b5160a4586ada51d","e6b2e57785ed448f9e093c1e28e453e9","9325c3a9f0904f048b79a6a627561538","ba155ddafc12444d9a0cdfaab7d756ed","557a8c879f274d36aa477326ad03cf91","0129f6d7786a45d6b0d70af96f9ab323","86b26c99244d46cb99b0efd99c93c5fd","1734adac5f0544db95d9f25fa1f6d0d9","37d44ec863924dfdaf9f98ee01a9c387","a73da2fa73fa4d3ab0ea0227749b24b4","cdfd1a2ea22b41889b92fa797439d7ea","2a4ec78b099141dba65754a223f1e9a3","6052253829364eac8c7ca225e1603d69","c33af11d9a474e01bc355ba4ae94b7ff","b9e406646e444c689c03c64038e7d109","5f09b8b853be4e6293b649d89512e59e","2de52d6a25a7438592c2994cc0f27171","477f02f61d7c4f7d836af721b032bd23","6d873619a9f44ffca3b6322126894f2b","cac983f604244cbb89791b7902240d80","e1b7c6fda072494f8ca95399a946f4d9","0fd252215a834f53a4c64af9b416cc43","33572facb8974c2fab2cea653ee47fcc","66ee5d4d25a847ce8604dbb70c93c065","85a382df9a3d4b38bece3b2cc8e0686b","6061c9055f5e46fc87010d5bb101584e","1a3fc8cb53f7405dbed1b995e41b5d3a","e7a3788a99b84f0cbf5b30bc63e2b7b7","564e85638c3c44faa01dff66cec402c7","052346c09f594ff89f57b7040da9d742","8e6da1b708b94836b613bdc0bd114eac","c598b4a57bd1472e99f4ca68175ca33d","dc910bfbecdd46a29ed0b1ffa49b3155","502b01cb1a5e41f9a62213656bc38551","2acae5a5cb6245d3994e93cc91342694","90872e6cdf38435bba76fdadb29c4a22","60a1385ce01249f2adf420b56e4ee615","25d442bcc29f4fb19b6843eb5557690c","924c8e1d18fc4d3686ba470edcd8bbfe","aa6efa18d99347ffbcd93da9f9e46f03","2f58ce9cb55f4313be44661e847f3c24","64d211d5db1d4e6b887f27c96d4efeb2","fd57d58cca864c72bd4423237c68aca3","cd00d307054247e7bf79cbe2f5cbf40d","a2405c0dd8c44165bfb613b96cbaaac2","9a07e820187042398caef7a046604071","3cbdb8828f724587a9b38dddf905e02b","d447113026db46969b81b6b51c01783e","090561859ebc473494dc9f23dd3696fb","f308ebe21c774456951fe3ebaa8a8ee0","e18727e0bdf74f65a706c1d9a3678d1b","39b0242fec5d44a890c0ba730b50e71a","cf520cec9b3141639ff6917d00f1b0db","2d81d5a123b742da80b511c6fee388a9","568adaad8ca449e080424dc010b6b779","fd8d913034ce4d8b848e5afbc061c8d8","e2eaf7410ecf4887bfa49d9de3bbe8b9","03cf95d92ac0400dbd5850d23a3e3046","d9a0bcfb34f3408f85f70f4d3db7693d","1b0b6162dede44b38818afaa31686d05","337696cbacb143ab8ced0101cc696429","2489dde1611e4bd7b5278f816ea2e547","27957fdf93e94226b703f29d06af1389","048cf7d46d1947f0810b486eef431f8f","a5e098d6d6ac4a41a3a0edd6e0f1b108","1655fed7821c41b8a264ca43f69a6d11","ad73bdaa895c4a6894b7a473d3e59b37","5ff749de171a4770add4d2250e2b4db7","3ad5ecdb231848a3b14fc7e212249d93","43c995c9f19149119c2999aff57bae5c","56eecc53c94343caa6ffb53135ac8cf6","e4c9b10f7015447fa46428349d4cf5ff","51fd77928cbc4d16a3427e1e5ae2c232","88d8ead1ef8d420490e9ee50aa46a6a6","1714837a319b4b078e31d56ac400b32d","92fe3694f5374719a4e020c1f0119457","a6fd2e5d5ae144ce9ae5ab3719454673","6333c2a1364a47a7a84d90ebd4974d3f","4a2bc0f596704d9b87a2e00bc95b3055","ac92047d20ef4ecf9289579a60389bd0","c5b6ed5d04d343ecbb2a9f856d305eb1","16d89817bef645b9a318e44846f13d6b","ab76775c58454e99b23bfeaa210ef8f9","ae981535552249fc9a3dce40f182aa26","ba254a2115304790a75a27ab15247b0d","febcbe5cab074e1aa2aab074ae1cc4ce","cc79905062af4f2cbdd93f36fbf839cb","cfaa11bbecf14776873081e64782a8ad","2d724795fec6410693bfd5fab289ed9f","f17faa5266444fc181ec8237569d730e","1aad101e96f1437db7e1c9ed4d5c0ffd","3b4c7d13af0e43e1808b9e0585e43f17","724eb1ac64fd4b1f85fa58a112efdb3a","eec91e51239948db8e56a20dd3abf2ea","cf3598cabd9b4226b38f88aad015047c","1f0393b9315447c09c84843cab6d003c","86c48b130834401498a1e661c7aeb919","b90464c9edfd4672ac62eae4314857fd","1787b0da33e0441e9e721cd31f74e6a1","bd2bd4845f8b44b98c95e07cfbe5bd56","809b7be1a38e462aa0298a2e87b49d43","83529499f8cc4a0999f2cbd3c75fb1af","f0bca50537964ebfbe43ffc0ff5b890e","91a8b8db719344af857429bb74da4b58","4aba0de753ad488d90df90c1b124dfaf","fd9d5dad262e4519a999d88ce1312faf","2d00de00de424962b950b3de9f49e221","f7863770d13e4cd8910b88755fbf4512","02e35ba92ced4c23affe58c3d90faa57","45d8b521027645838f7d8d75cdd1eac6","16a1ca0f46764d3690d04d562de2fd59","0f4967012fa84d7e8641c71534a2d3d4","061e53d91d17470a95b0a8d90b702088","b9e44caf4ef34d4982c460e7a6603c14","5336366743a5400a842acf7f51fa6f6d"]},"id":"s8CIJO1s153s","outputId":"882a7ab2-9969-498c-c465-d5bcc6b80619"},"outputs":[{"output_type":"stream","name":"stdout","text":["12477 3117\n","12474 3120\n","12475 3119\n","12475 3119\n","12475 3119\n","0    28997\n","2    28968\n","3    28904\n","1    28737\n","4    28687\n","Name: kfold, dtype: int64\n","Training Fold 3\n"]},{"output_type":"stream","name":"stderr","text":["Token indices sequence length is longer than the specified maximum sequence length for this model (693 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (514 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (555 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (632 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (547 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (544 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (632 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (643 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (558 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (823 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (516 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (647 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (539 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (784 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (670 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (933 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (533 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (874 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (667 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (645 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (875 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (2154 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (574 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (560 > 512). Running this sequence through the model will result in indexing errors\n","Some weights of the model checkpoint at microsoft/deberta-large were not used when initializing DebertaModel: ['lm_predictions.lm_head.dense.bias', 'lm_predictions.lm_head.LayerNorm.weight', 'lm_predictions.lm_head.bias', 'lm_predictions.lm_head.LayerNorm.bias', 'lm_predictions.lm_head.dense.weight']\n","- This IS expected if you are initializing DebertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DebertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"stream","name":"stdout","text":["==================== Epoch: 1 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e644566c906c43548674e19c0186aee8","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Training loss: 0.3215 Training f1: 0.7805\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"783ce614985241cba817b1f7dfc05f9f","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1560 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["(0.6611747989724713, {'Claim': 0.6267550498460254, 'Concluding Statement': 0.814628899247042, 'Counterclaim': 0.537808329963607, 'Evidence': 0.746776523460489, 'Lead': 0.7962493664470349, 'Position': 0.7023941652132552, 'Rebuttal': 0.403611258629846})\n","Validation Score: 0.6612\n","Saved model with val_score: 0.6612\n","==================== Epoch: 2 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"22ff59eff56d4c83836a16f44124888a","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Training loss: 0.3040 Training f1: 0.7935\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"0129f6d7786a45d6b0d70af96f9ab323","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1560 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["(0.6767880333855973, {'Claim': 0.6410028625012338, 'Concluding Statement': 0.8432256900595345, 'Counterclaim': 0.5322930212397052, 'Evidence': 0.7579185520361991, 'Lead': 0.8070175438596491, 'Position': 0.7077069156512107, 'Rebuttal': 0.44835164835164837})\n","Validation Score: 0.6768\n","Saved model with val_score: 0.6768\n","==================== Epoch: 3 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2de52d6a25a7438592c2994cc0f27171","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Training loss: 0.2386 Training f1: 0.8309\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e7a3788a99b84f0cbf5b30bc63e2b7b7","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1560 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["(0.6786478327740821, {'Claim': 0.6384032634032634, 'Concluding Statement': 0.8446056210335449, 'Counterclaim': 0.5475285171102662, 'Evidence': 0.758765778401122, 'Lead': 0.7984375, 'Position': 0.7141041931385006, 'Rebuttal': 0.44868995633187775})\n","Validation Score: 0.6786\n","Saved model with val_score: 0.6786\n","==================== Epoch: 4 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"924c8e1d18fc4d3686ba470edcd8bbfe","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Training loss: 0.2127 Training f1: 0.8459\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"f308ebe21c774456951fe3ebaa8a8ee0","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1560 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["(0.677600122163316, {'Claim': 0.6383623216728552, 'Concluding Statement': 0.8451973328527662, 'Counterclaim': 0.541908713692946, 'Evidence': 0.7547781017168772, 'Lead': 0.7981293842556508, 'Position': 0.7157360406091371, 'Rebuttal': 0.4490889603429796})\n","Validation Score: 0.6776\n","==================== Epoch: 5 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"337696cbacb143ab8ced0101cc696429","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Training loss: 0.2212 Training f1: 0.8404\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e4c9b10f7015447fa46428349d4cf5ff","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1560 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["(0.6702625601737943, {'Claim': 0.6327365981160922, 'Concluding Statement': 0.8376130198915009, 'Counterclaim': 0.5270693512304251, 'Evidence': 0.7523154416941992, 'Lead': 0.8054823405376911, 'Position': 0.707808564231738, 'Rebuttal': 0.4288126055149128})\n","Validation Score: 0.6703\n","==================== Epoch: 6 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ab76775c58454e99b23bfeaa210ef8f9","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Training loss: 0.2196 Training f1: 0.8431\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"eec91e51239948db8e56a20dd3abf2ea","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1560 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["(0.6707955348626263, {'Claim': 0.6275071633237822, 'Concluding Statement': 0.8368459302325582, 'Counterclaim': 0.545, 'Evidence': 0.7465693748638641, 'Lead': 0.8012486992715921, 'Position': 0.6978496311411081, 'Rebuttal': 0.44054794520547946})\n","Validation Score: 0.6708\n","Training Fold 4\n"]},{"output_type":"stream","name":"stderr","text":["Token indices sequence length is longer than the specified maximum sequence length for this model (605 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (514 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (537 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (566 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (573 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (657 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (774 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (548 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (613 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (534 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (1045 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (633 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (693 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (787 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (590 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (537 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (666 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (613 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (633 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (581 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (536 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (873 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (1025 > 512). Running this sequence through the model will result in indexing errors\n","Token indices sequence length is longer than the specified maximum sequence length for this model (647 > 512). Running this sequence through the model will result in indexing errors\n","Some weights of the model checkpoint at microsoft/deberta-large were not used when initializing DebertaModel: ['lm_predictions.lm_head.dense.bias', 'lm_predictions.lm_head.LayerNorm.weight', 'lm_predictions.lm_head.bias', 'lm_predictions.lm_head.LayerNorm.bias', 'lm_predictions.lm_head.dense.weight']\n","- This IS expected if you are initializing DebertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DebertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"stream","name":"stdout","text":["==================== Epoch: 1 / 6 ====================\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4aba0de753ad488d90df90c1b124dfaf","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/6238 [00:00<?, ?it/s]"]},"metadata":{}}],"source":["if __name__ == \"__main__\":\n","    df = pd.read_csv(os.path.join(Config.input, \"corrected_train.csv\"))\n","    if Config.debug:\n","        df = df[:100]\n","    df = create_folds(df)\n","\n","    os.makedirs(\"models\", exist_ok = True)\n","    for fold in range(3,5):\n","\n","        print(f\"Training Fold {fold}\")\n","        train_df = df[df[\"kfold\"] != fold].reset_index(drop=True)\n","        valid_df = df[df[\"kfold\"] == fold].reset_index(drop=True)\n","\n","        # tokenizer = AutoTokenizer.from_pretrained(Config.model)\n","        tokenizer = AutoTokenizer.from_pretrained(Config.model)\n","        collate = Collate(tokenizer)\n","\n","        training_samples = prepare_training_data(train_df, tokenizer, Config, num_jobs=Config.num_workers)\n","        valid_samples = prepare_training_data(valid_df, tokenizer, Config, num_jobs=Config.num_workers)\n","\n","        train_dataset = FeedbackDataset(training_samples, Config.max_len, tokenizer)\n","        valid_dataset = FeedbackDatasetValid(valid_samples, Config.max_len_valid, tokenizer)\n","\n","        num_train_steps = int(len(train_dataset) / Config.batch_size / Config.accumulation_steps * Config.epochs)\n","        # num_train_steps = int(len(train_dataset) / Config.batch_size / Config.accumulation_steps * 6)\n","        model = FeedbackModel(Config.model,\n","                            Config.num_labels)\n","        model.to(Config.device)\n","        model.load_state_dict(torch.load(f\"/content/deberta/FB_deberta-large/models/model_{fold}\"))\n","        optimizer = fetch_optimizer(model)\n","        scheduler = fetch_scheduler(optimizer, num_train_steps)\n","        \n","        train_loader = torch.utils.data.DataLoader(train_dataset,\n","                                                batch_size = Config.batch_size,\n","                                                pin_memory = True,\n","                                                num_workers = Config.num_workers,  \n","                                                shuffle = True)\n","        \n","        valid_loader = torch.utils.data.DataLoader(valid_dataset,\n","                                                batch_size = Config.valid_batch_size,\n","                                                pin_memory = True,\n","                                                collate_fn = collate,\n","                                                num_workers = Config.num_workers,  \n","                                                shuffle = False)\n","\n","        trainer = Trainer(config = Config,\n","                        dataloaders =(train_loader, valid_loader) ,\n","                        valid_df = valid_df,\n","                        valid_samples = valid_samples,\n","                        optimizer = optimizer,\n","                        model = model,\n","                        loss_fns = criterion,\n","                        scheduler = scheduler)\n","        \n","        trainer.fit(fold,\n","                    Config.epochs)\n","        \n","        del model\n","        gc.collect()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zTVi5bhV2Y7C"},"outputs":[],"source":["savefile = f\"/content/drive/MyDrive/FB_{Config.savename}.zip\"\n","! zip -r $savefile models"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SdNiBueZc78E"},"outputs":[],"source":[""]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"name":"FB Train Pytorch  - 1","provenance":[],"mount_file_id":"11fADdjpN0vK_afa9wqB6h73PR4aK7XeQ","authorship_tag":"ABX9TyMDQk4+3wyc6dYXJ+C+YWou"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"e644566c906c43548674e19c0186aee8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d88e2ed4cf8c4a0baff0e8116dfe09e0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_671fdff3cf0345cdb2747c5d9f5850eb","IPY_MODEL_59f18f261c2e4770b0cbfd8b2026713d","IPY_MODEL_189f84fc133c4db5a7ea22c3e8007483"]}},"d88e2ed4cf8c4a0baff0e8116dfe09e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"671fdff3cf0345cdb2747c5d9f5850eb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cd62091139b94bb18c6a3b29d14f3d37","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dc8d4fee5beb4c4f97bcbcb20fd273a1"}},"59f18f261c2e4770b0cbfd8b2026713d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_52aaa717be2c4557b7c18706e29a8f41","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":6238,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_82064fb7e26649b48901631c8e7c0b3e"}},"189f84fc133c4db5a7ea22c3e8007483":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_14c159c08757403a92984dd9d180780e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 6238/6238 [1:30:47&lt;00:00,  1.44it/s, LR=2.37e-5, Train_F1=0.781, Train_Loss=0.321]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_68fd6cc7b8af450f8cfa5bae844d8be5"}},"cd62091139b94bb18c6a3b29d14f3d37":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"dc8d4fee5beb4c4f97bcbcb20fd273a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"52aaa717be2c4557b7c18706e29a8f41":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"82064fb7e26649b48901631c8e7c0b3e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"14c159c08757403a92984dd9d180780e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"68fd6cc7b8af450f8cfa5bae844d8be5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"783ce614985241cba817b1f7dfc05f9f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e38244e2380a4acd80639aadc2e3aae8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_15913776fa634e288bea19ace1b13f70","IPY_MODEL_61e6d4dc41444e8494589bd8cc2be82c","IPY_MODEL_6f8637f8f1294c4982754c64b045ac26"]}},"e38244e2380a4acd80639aadc2e3aae8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"15913776fa634e288bea19ace1b13f70":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_197212a17cb7479da176793418fc458a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b98f6879773f45a7b2bf7523dd1d5880"}},"61e6d4dc41444e8494589bd8cc2be82c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2047cbd9da834930a3ed27fede5bb54e","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1560,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1560,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_27e1b63dc8b44c1aa944690c2d0ea6a6"}},"6f8637f8f1294c4982754c64b045ac26":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_887462b628cd4535954cd8f4e0a8cf3c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1560/1560 [01:47&lt;00:00, 11.79it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3d018af7a6c34e40a4d03ee8a0fbf6ee"}},"197212a17cb7479da176793418fc458a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b98f6879773f45a7b2bf7523dd1d5880":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2047cbd9da834930a3ed27fede5bb54e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"27e1b63dc8b44c1aa944690c2d0ea6a6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"887462b628cd4535954cd8f4e0a8cf3c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3d018af7a6c34e40a4d03ee8a0fbf6ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"22ff59eff56d4c83836a16f44124888a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ceff6e6318ef41979e42164dbb4c474f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_cfffd69f142e4e11b5b7fc8d06899745","IPY_MODEL_e3ff827dfa304672bc150118f0d5649b","IPY_MODEL_0f84e59931904720bf271b427cd089d8"]}},"ceff6e6318ef41979e42164dbb4c474f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cfffd69f142e4e11b5b7fc8d06899745":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a1869837763641f1821125b1bcfbfdc9","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cc0dcc1deb5d44a2b5160a4586ada51d"}},"e3ff827dfa304672bc150118f0d5649b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e6b2e57785ed448f9e093c1e28e453e9","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":6238,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9325c3a9f0904f048b79a6a627561538"}},"0f84e59931904720bf271b427cd089d8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ba155ddafc12444d9a0cdfaab7d756ed","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 6238/6238 [1:30:58&lt;00:00,  1.39it/s, LR=1.18e-5, Train_F1=0.793, Train_Loss=0.304]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_557a8c879f274d36aa477326ad03cf91"}},"a1869837763641f1821125b1bcfbfdc9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cc0dcc1deb5d44a2b5160a4586ada51d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e6b2e57785ed448f9e093c1e28e453e9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9325c3a9f0904f048b79a6a627561538":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ba155ddafc12444d9a0cdfaab7d756ed":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"557a8c879f274d36aa477326ad03cf91":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0129f6d7786a45d6b0d70af96f9ab323":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_86b26c99244d46cb99b0efd99c93c5fd","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1734adac5f0544db95d9f25fa1f6d0d9","IPY_MODEL_37d44ec863924dfdaf9f98ee01a9c387","IPY_MODEL_a73da2fa73fa4d3ab0ea0227749b24b4"]}},"86b26c99244d46cb99b0efd99c93c5fd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1734adac5f0544db95d9f25fa1f6d0d9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cdfd1a2ea22b41889b92fa797439d7ea","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2a4ec78b099141dba65754a223f1e9a3"}},"37d44ec863924dfdaf9f98ee01a9c387":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6052253829364eac8c7ca225e1603d69","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1560,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1560,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c33af11d9a474e01bc355ba4ae94b7ff"}},"a73da2fa73fa4d3ab0ea0227749b24b4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b9e406646e444c689c03c64038e7d109","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1560/1560 [01:46&lt;00:00, 16.18it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5f09b8b853be4e6293b649d89512e59e"}},"cdfd1a2ea22b41889b92fa797439d7ea":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2a4ec78b099141dba65754a223f1e9a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6052253829364eac8c7ca225e1603d69":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c33af11d9a474e01bc355ba4ae94b7ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b9e406646e444c689c03c64038e7d109":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5f09b8b853be4e6293b649d89512e59e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2de52d6a25a7438592c2994cc0f27171":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_477f02f61d7c4f7d836af721b032bd23","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_6d873619a9f44ffca3b6322126894f2b","IPY_MODEL_cac983f604244cbb89791b7902240d80","IPY_MODEL_e1b7c6fda072494f8ca95399a946f4d9"]}},"477f02f61d7c4f7d836af721b032bd23":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6d873619a9f44ffca3b6322126894f2b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0fd252215a834f53a4c64af9b416cc43","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_33572facb8974c2fab2cea653ee47fcc"}},"cac983f604244cbb89791b7902240d80":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_66ee5d4d25a847ce8604dbb70c93c065","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":6238,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_85a382df9a3d4b38bece3b2cc8e0686b"}},"e1b7c6fda072494f8ca95399a946f4d9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6061c9055f5e46fc87010d5bb101584e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 6238/6238 [1:30:43&lt;00:00,  1.42it/s, LR=7.52e-7, Train_F1=0.831, Train_Loss=0.239]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1a3fc8cb53f7405dbed1b995e41b5d3a"}},"0fd252215a834f53a4c64af9b416cc43":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"33572facb8974c2fab2cea653ee47fcc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"66ee5d4d25a847ce8604dbb70c93c065":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"85a382df9a3d4b38bece3b2cc8e0686b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6061c9055f5e46fc87010d5bb101584e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1a3fc8cb53f7405dbed1b995e41b5d3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e7a3788a99b84f0cbf5b30bc63e2b7b7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_564e85638c3c44faa01dff66cec402c7","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_052346c09f594ff89f57b7040da9d742","IPY_MODEL_8e6da1b708b94836b613bdc0bd114eac","IPY_MODEL_c598b4a57bd1472e99f4ca68175ca33d"]}},"564e85638c3c44faa01dff66cec402c7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"052346c09f594ff89f57b7040da9d742":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_dc910bfbecdd46a29ed0b1ffa49b3155","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_502b01cb1a5e41f9a62213656bc38551"}},"8e6da1b708b94836b613bdc0bd114eac":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2acae5a5cb6245d3994e93cc91342694","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1560,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1560,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_90872e6cdf38435bba76fdadb29c4a22"}},"c598b4a57bd1472e99f4ca68175ca33d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_60a1385ce01249f2adf420b56e4ee615","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1560/1560 [01:46&lt;00:00, 16.11it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_25d442bcc29f4fb19b6843eb5557690c"}},"dc910bfbecdd46a29ed0b1ffa49b3155":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"502b01cb1a5e41f9a62213656bc38551":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2acae5a5cb6245d3994e93cc91342694":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"90872e6cdf38435bba76fdadb29c4a22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"60a1385ce01249f2adf420b56e4ee615":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"25d442bcc29f4fb19b6843eb5557690c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"924c8e1d18fc4d3686ba470edcd8bbfe":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_aa6efa18d99347ffbcd93da9f9e46f03","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2f58ce9cb55f4313be44661e847f3c24","IPY_MODEL_64d211d5db1d4e6b887f27c96d4efeb2","IPY_MODEL_fd57d58cca864c72bd4423237c68aca3"]}},"aa6efa18d99347ffbcd93da9f9e46f03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2f58ce9cb55f4313be44661e847f3c24":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cd00d307054247e7bf79cbe2f5cbf40d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a2405c0dd8c44165bfb613b96cbaaac2"}},"64d211d5db1d4e6b887f27c96d4efeb2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9a07e820187042398caef7a046604071","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":6238,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3cbdb8828f724587a9b38dddf905e02b"}},"fd57d58cca864c72bd4423237c68aca3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d447113026db46969b81b6b51c01783e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 6238/6238 [1:30:43&lt;00:00,  1.43it/s, LR=3.93e-6, Train_F1=0.846, Train_Loss=0.213]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_090561859ebc473494dc9f23dd3696fb"}},"cd00d307054247e7bf79cbe2f5cbf40d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a2405c0dd8c44165bfb613b96cbaaac2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9a07e820187042398caef7a046604071":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3cbdb8828f724587a9b38dddf905e02b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d447113026db46969b81b6b51c01783e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"090561859ebc473494dc9f23dd3696fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f308ebe21c774456951fe3ebaa8a8ee0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e18727e0bdf74f65a706c1d9a3678d1b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_39b0242fec5d44a890c0ba730b50e71a","IPY_MODEL_cf520cec9b3141639ff6917d00f1b0db","IPY_MODEL_2d81d5a123b742da80b511c6fee388a9"]}},"e18727e0bdf74f65a706c1d9a3678d1b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"39b0242fec5d44a890c0ba730b50e71a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_568adaad8ca449e080424dc010b6b779","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fd8d913034ce4d8b848e5afbc061c8d8"}},"cf520cec9b3141639ff6917d00f1b0db":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e2eaf7410ecf4887bfa49d9de3bbe8b9","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1560,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1560,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_03cf95d92ac0400dbd5850d23a3e3046"}},"2d81d5a123b742da80b511c6fee388a9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d9a0bcfb34f3408f85f70f4d3db7693d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1560/1560 [01:47&lt;00:00, 16.07it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1b0b6162dede44b38818afaa31686d05"}},"568adaad8ca449e080424dc010b6b779":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"fd8d913034ce4d8b848e5afbc061c8d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e2eaf7410ecf4887bfa49d9de3bbe8b9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"03cf95d92ac0400dbd5850d23a3e3046":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d9a0bcfb34f3408f85f70f4d3db7693d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1b0b6162dede44b38818afaa31686d05":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"337696cbacb143ab8ced0101cc696429":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_2489dde1611e4bd7b5278f816ea2e547","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_27957fdf93e94226b703f29d06af1389","IPY_MODEL_048cf7d46d1947f0810b486eef431f8f","IPY_MODEL_a5e098d6d6ac4a41a3a0edd6e0f1b108"]}},"2489dde1611e4bd7b5278f816ea2e547":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"27957fdf93e94226b703f29d06af1389":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1655fed7821c41b8a264ca43f69a6d11","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ad73bdaa895c4a6894b7a473d3e59b37"}},"048cf7d46d1947f0810b486eef431f8f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5ff749de171a4770add4d2250e2b4db7","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":6238,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3ad5ecdb231848a3b14fc7e212249d93"}},"a5e098d6d6ac4a41a3a0edd6e0f1b108":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_43c995c9f19149119c2999aff57bae5c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 6238/6238 [1:30:43&lt;00:00,  1.39it/s, LR=1.75e-5, Train_F1=0.84, Train_Loss=0.221]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_56eecc53c94343caa6ffb53135ac8cf6"}},"1655fed7821c41b8a264ca43f69a6d11":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ad73bdaa895c4a6894b7a473d3e59b37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5ff749de171a4770add4d2250e2b4db7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3ad5ecdb231848a3b14fc7e212249d93":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"43c995c9f19149119c2999aff57bae5c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"56eecc53c94343caa6ffb53135ac8cf6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e4c9b10f7015447fa46428349d4cf5ff":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_51fd77928cbc4d16a3427e1e5ae2c232","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_88d8ead1ef8d420490e9ee50aa46a6a6","IPY_MODEL_1714837a319b4b078e31d56ac400b32d","IPY_MODEL_92fe3694f5374719a4e020c1f0119457"]}},"51fd77928cbc4d16a3427e1e5ae2c232":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"88d8ead1ef8d420490e9ee50aa46a6a6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a6fd2e5d5ae144ce9ae5ab3719454673","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6333c2a1364a47a7a84d90ebd4974d3f"}},"1714837a319b4b078e31d56ac400b32d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4a2bc0f596704d9b87a2e00bc95b3055","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1560,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1560,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ac92047d20ef4ecf9289579a60389bd0"}},"92fe3694f5374719a4e020c1f0119457":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c5b6ed5d04d343ecbb2a9f856d305eb1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1560/1560 [01:47&lt;00:00, 12.84it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_16d89817bef645b9a318e44846f13d6b"}},"a6fd2e5d5ae144ce9ae5ab3719454673":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6333c2a1364a47a7a84d90ebd4974d3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4a2bc0f596704d9b87a2e00bc95b3055":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ac92047d20ef4ecf9289579a60389bd0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c5b6ed5d04d343ecbb2a9f856d305eb1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"16d89817bef645b9a318e44846f13d6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ab76775c58454e99b23bfeaa210ef8f9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ae981535552249fc9a3dce40f182aa26","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ba254a2115304790a75a27ab15247b0d","IPY_MODEL_febcbe5cab074e1aa2aab074ae1cc4ce","IPY_MODEL_cc79905062af4f2cbdd93f36fbf839cb"]}},"ae981535552249fc9a3dce40f182aa26":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ba254a2115304790a75a27ab15247b0d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cfaa11bbecf14776873081e64782a8ad","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2d724795fec6410693bfd5fab289ed9f"}},"febcbe5cab074e1aa2aab074ae1cc4ce":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f17faa5266444fc181ec8237569d730e","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":6238,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1aad101e96f1437db7e1c9ed4d5c0ffd"}},"cc79905062af4f2cbdd93f36fbf839cb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3b4c7d13af0e43e1808b9e0585e43f17","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 6238/6238 [1:30:47&lt;00:00,  1.35it/s, LR=2.5e-5, Train_F1=0.843, Train_Loss=0.22]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_724eb1ac64fd4b1f85fa58a112efdb3a"}},"cfaa11bbecf14776873081e64782a8ad":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2d724795fec6410693bfd5fab289ed9f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f17faa5266444fc181ec8237569d730e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1aad101e96f1437db7e1c9ed4d5c0ffd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3b4c7d13af0e43e1808b9e0585e43f17":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"724eb1ac64fd4b1f85fa58a112efdb3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"eec91e51239948db8e56a20dd3abf2ea":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_cf3598cabd9b4226b38f88aad015047c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1f0393b9315447c09c84843cab6d003c","IPY_MODEL_86c48b130834401498a1e661c7aeb919","IPY_MODEL_b90464c9edfd4672ac62eae4314857fd"]}},"cf3598cabd9b4226b38f88aad015047c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1f0393b9315447c09c84843cab6d003c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1787b0da33e0441e9e721cd31f74e6a1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bd2bd4845f8b44b98c95e07cfbe5bd56"}},"86c48b130834401498a1e661c7aeb919":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_809b7be1a38e462aa0298a2e87b49d43","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1560,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1560,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_83529499f8cc4a0999f2cbd3c75fb1af"}},"b90464c9edfd4672ac62eae4314857fd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f0bca50537964ebfbe43ffc0ff5b890e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1560/1560 [01:46&lt;00:00, 16.02it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_91a8b8db719344af857429bb74da4b58"}},"1787b0da33e0441e9e721cd31f74e6a1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bd2bd4845f8b44b98c95e07cfbe5bd56":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"809b7be1a38e462aa0298a2e87b49d43":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"83529499f8cc4a0999f2cbd3c75fb1af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f0bca50537964ebfbe43ffc0ff5b890e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"91a8b8db719344af857429bb74da4b58":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4aba0de753ad488d90df90c1b124dfaf":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fd9d5dad262e4519a999d88ce1312faf","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2d00de00de424962b950b3de9f49e221","IPY_MODEL_f7863770d13e4cd8910b88755fbf4512","IPY_MODEL_02e35ba92ced4c23affe58c3d90faa57"]}},"fd9d5dad262e4519a999d88ce1312faf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2d00de00de424962b950b3de9f49e221":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_45d8b521027645838f7d8d75cdd1eac6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"  0%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_16a1ca0f46764d3690d04d562de2fd59"}},"f7863770d13e4cd8910b88755fbf4512":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0f4967012fa84d7e8641c71534a2d3d4","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":6238,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":11,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_061e53d91d17470a95b0a8d90b702088"}},"02e35ba92ced4c23affe58c3d90faa57":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b9e44caf4ef34d4982c460e7a6603c14","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 11/6238 [00:10&lt;1:30:24,  1.15it/s, LR=7.35e-8, Train_F1=0.791, Train_Loss=0.319]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5336366743a5400a842acf7f51fa6f6d"}},"45d8b521027645838f7d8d75cdd1eac6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"16a1ca0f46764d3690d04d562de2fd59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0f4967012fa84d7e8641c71534a2d3d4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"061e53d91d17470a95b0a8d90b702088":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b9e44caf4ef34d4982c460e7a6603c14":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5336366743a5400a842acf7f51fa6f6d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"nbformat":4,"nbformat_minor":0}